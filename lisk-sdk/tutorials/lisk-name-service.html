<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lisk Name Service (LNS) Tutorial - Lisk  SDK  Docs</title>
    <link rel="canonical" href="https://lisk.io/documentation/lisk-sdk/tutorials/lisk-name-service.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/site-extra.css">
      <link rel="stylesheet" href="../../_/css/vendor/docsearch.min.css">
      <!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script src="../../_/js/vendor/medium-zoom.min.js"></script>
<link rel="icon" href="../../_/img/favicon.png" type="image/x-icon">
  </head>
  <body class="article">
<script data-cookieconsent="ignore" type="text/javascript" id="GTM">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({"gtm.start":
          new Date().getTime(),event:"gtm.js"});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!="dataLayer"?"&amp;l="+l:"";j.async=true;
  j.crossOrigin="anonymous";j.src=
          "https://www.googletagmanager.com/gtm.js?id="+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,"script","dataLayer","GTM-NKNKGHL");</script>

<script type="text/javascript" id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="e4db29b5-cd94-4bcf-87e4-04f4ca564240" data-blockingmode="manual"></script>
<header class="header">
  <nav class="navbar">
      <div class="navbar-content">
        <div class="navbar-brand">
          <a href="https://lisk.io" title="Lisk.io" class="lisk-logo"></a>
            <span  class="nav-brand__name-area">
              <strong class="nav-brand__name-area__title">SDK</strong>
                        </span>
          <div class="top-versions page-versions">
  <button class="version-menu-toggle top-version-menu-toggle" title="Show other versions of page">5.1.4 (latest)</button>
  <div class="version-menu">
    <a class="version is-current" href="lisk-name-service.html">5.1.4 (latest)</a>
    <a class="version is-missing" href="../v4/index.html">4.0.0</a>
    <a class="version is-missing" href="../v3/index.html">3.0.2</a>
    <a class="version is-missing" href="../v2/index.html">2.3.9</a>
  </div>
</div>
          <button class="navbar-burger" data-target="topbar-nav">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>
        <div id="topbar-nav" class="navbar-menu">
          <div class="navbar-end">
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="">Documentations</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/">Lisk SDK</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-service/">Lisk Service</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-core/">Lisk Core</a>
              </div>
            </div>
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="">Resources</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" href=""><strong>Lisk Service API</strong></a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-service/references/api.html">Mainnet</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-service/references/api-testnet.html">Testnet</a>
                <hr class="navbar-divider">
                <a class="navbar-item" href=""><strong>Lisk Network Explorer</strong></a>
                <a class="navbar-item" target="_blank" href="https://lisk.observer/">Lisk Observer<i class="icofont-external-link"></i></a>
                <a class="navbar-item" target="_blank" href="https://liskscan.io/">LISKscan<i class="icofont-external-link"></i></a>
              </div>
            </div>
          </div>
            <div class="navbar-menu search-box hide-for-print">
              <input id="search-input" type="text" placeholder="Search">
            </div>
        </div>
        <div class="navbar-item navbar-right">
<!--
          <a href="https://lisk.chat" title="Lisk Chat" target="_blank" class="footer__icon icon-discord-2x"></a>
-->
          <a href="https://github.com/LiskHQ" title="Lisk GitHub" target="_blank" class="footer__icon icon-github-2x"></a>
          <span class="control">
            <a class="button is-primary" target="_blank" title="Lisk Dev Forum" href="https://dev.lisk.io/">Get help</a>
          </span>
        </div>
      </div>
  </nav>
</header>
<div class="body-container">
  <div class="body">
<div class="nav-container" data-component="lisk-sdk" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Lisk SDK</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="1">
    <a class="nav-link" href="../index.html">Getting started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../introduction/blockchain-applications.html">Blockchain applications</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../introduction/modules.html">Modules</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../introduction/plugins.html">Plugins</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Advanced explanations</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../advanced-explanations/architecture.html">SDK Architecture</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../advanced-explanations/communication.html">Communication</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../advanced-explanations/rpc-endpoints.html">RPC endpoints</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../advanced-explanations/schemas.html">Schemas</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Development guides</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../guides/app-development/setup.html">Creating a new blockchain application</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../guides/app-development/module.html">Creating a module</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../guides/app-development/asset.html">Creating a module asset</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../guides/app-development/plugin.html">Creating a plugin</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../guides/app-development/genesis-block.html">Generating a genesis block</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../guides/app-development/configuration.html">Configuring a blockchain application</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../guides/app-development/dashboard.html">Interacting with the blockchain application via the dashboard plugin</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../guides/app-development/testing.html">Testing the application</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Management guides</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../guides/node-management/forging.html">Enabling forging</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../guides/node-management/logging.html">Managing logs</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../guides/node-management/signing-transactions-offline.html">Creating transactions and signing them offline</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../guides/node-management/non-forging-node-protection.html">Protecting a non-forging node</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../guides/node-management/forging-node-protection.html">Protecting a forging node</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tutorials</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="index.html">Tutorials overview</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="nft.html">Non-fungible token (NFT) Tutorial</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="srs.html">Social Recovery System (SRS) Tutorial</a>
  </li>
  <li class="nav-item is-current-page single-page" data-depth="2">
    <a class="nav-link" href="lisk-name-service.html">Lisk Name Service (LNS) Tutorial</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">References</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../references/application-cli.html">Application CLI Commands</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../references/config.html">Configuration reference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Lisk Commander</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../references/lisk-commander/index.html">What is Lisk Commander?</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../references/lisk-commander/commands.html">Commands</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../references/lisk-commander/sensitive-inputs.html">Sensitive inputs</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Lisk Elements</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../references/lisk-elements/index.html">What is Lisk Elements?</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Frontend</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/client.html">Client</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Backend</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/api-client.html">API client</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/bft.html">BFT</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/chain.html">Chain</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/codec.html">Codec</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/cryptography.html">Cryptography</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/db.html">DB</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/genesis.html">Genesis</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/p2p.html">P2P</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/passphrase.html">Passphrase</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/transaction-pool.html">Transaction pool</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/transactions.html">Transactions</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/tree.html">Tree</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/utils.html">Utils</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-elements/validator.html">Validator</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Lisk Framework</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../references/lisk-framework/index.html">Framework interfaces</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../references/lisk-framework/test-suite.html">The Lisk SDK testing utilities</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">SDK modules</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-framework/token-module.html">Token module</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-framework/sequence-module.html">Sequence module</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-framework/keys-module.html">Keys module</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-framework/dpos-module.html">DPoS module</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">SDK plugins</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-framework/http-api-plugin.html">HTTP API plugin</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-framework/dashboard-plugin.html">Dashboard plugin</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-framework/faucet-plugin.html">Faucet plugin</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-framework/forger-plugin.html">Forger plugin</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-framework/report-misbehavior-plugin.html">Report misbehavior plugin</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../references/lisk-framework/monitor-plugin.html">Monitor plugin</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item single-page" data-depth="1">
    <a class="nav-link" href="../glossary.html">Glossary and Abbreviations</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Lisk protocol</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../protocol/index.html">What is the Lisk protocol?</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../protocol/accounts.html">Accounts</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../protocol/transactions.html">Transactions</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../protocol/blocks.html">Blocks</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../protocol/consensus-algorithm.html">Consensus algorithm</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../protocol/network.html">Network</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../protocol/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Lisk SDK</span>
    <span class="version">5.1.4 (latest)</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Lisk Core</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../lisk-core/index.html">3.0.1</a>
        </li>
        <li class="version">
          <a href="../../lisk-core/v2/index.html">2.1.7</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Lisk docs manual</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../lisk-docs-manual/index.html">0.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Lisk SDK</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">5.1.4 (latest)</a>
        </li>
        <li class="version">
          <a href="../v4/index.html">4.0.0</a>
        </li>
        <li class="version">
          <a href="../v3/index.html">3.0.2</a>
        </li>
        <li class="version">
          <a href="../v2/index.html">2.3.9</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Lisk Service</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../lisk-service/index.html">0.4.3 (latest)</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" title="Home" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Lisk SDK</a></li>
    <li>Tutorials</li>
    <li><a href="lisk-name-service.html">Lisk Name Service (LNS) Tutorial</a></li>
  </ul>
</nav>
  <div class="page-versions toolbar-versions">
  <button class="version-menu-toggle" title="Show other versions of page">5.1.4 (latest)</button>
  <div class="version-menu">
    <a class="version is-current" href="lisk-name-service.html">5.1.4 (latest)</a>
    <a class="version is-missing" href="../v4/index.html">4.0.0</a>
    <a class="version is-missing" href="../v3/index.html">3.0.2</a>
    <a class="version is-missing" href="../v2/index.html">2.3.9</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/LiskHQ/lisk-docs/edit/1151-lns-tutorial/modules/ROOT/pages/tutorials/lisk-name-service.adoc"><i class="icofont-ui-edit"></i>Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Lisk Name Service (LNS) Tutorial</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>How to create a blockchain application that offers a domain name service for blockchain accounts, similar to <a href="https://en.wikipedia.org/wiki/Domain_Name_System" target="_blank" rel="noopener">DNS</a> and <a href="https://docs.ens.domains/" target="_blank" rel="noopener">ENS</a>.</p>
</div>
<div class="paragraph">
<p>This service allows an account to register one or multiple <code>.lsk</code> domains for a certain amount of time (1-5 years).</p>
</div>
<div class="paragraph">
<p>If an account registers a domain, it becomes a human readable identifier for the account and can then be used to refer to the account instead of the (less human-readable) Lisk32 account address.</p>
</div>
<div class="paragraph">
<p>Additionally, it is possible to create TXT and CNAME records for each domain owned by an account.</p>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#lns-application-overview">LNS application overview</a></li>
<li><a href="#dependencies">1. Dependencies</a>
<ul class="sectlevel2">
<li><a href="#node-js">1.1. Node.js</a></li>
<li><a href="#lisk-commander">1.2. Lisk Commander</a></li>
</ul>
</li>
<li><a href="#bootstrapping-the-default-application">2. Bootstrapping the default application</a></li>
<li><a href="#creating-the-lns-module-assets">3. Creating the LNS module assets</a>
<ul class="sectlevel2">
<li><a href="#register-domain">3.1. Register Domain</a>
<ul class="sectlevel3">
<li><a href="#schema">3.1.1. Schema</a></li>
<li><a href="#validation">3.1.2. Validation</a></li>
<li><a href="#state-change">3.1.3. State change</a></li>
<li><a href="#utility-functions">3.1.4. Utility functions</a>
<ul class="sectlevel4">
<li><a href="#getnodefornamename">getNodeForName(name)</a></li>
<li><a href="#createlnsobjectstatestore-params">createLNSObject(stateStore, params)</a></li>
<li><a href="#getlnsobjectstatestore-node">getLNSObject(stateStore, node)</a></li>
</ul>
</li>
<li><a href="#schemas">3.1.5. Schemas</a>
<ul class="sectlevel4">
<li><a href="#lns-node-record-schema">LNS node record schema</a></li>
<li><a href="#lns-node-schema">LNS node schema</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#update-reverse-lookup">3.2. Update reverse lookup</a>
<ul class="sectlevel3">
<li><a href="#schema-2">3.2.1. Schema</a></li>
<li><a href="#state-change-2">3.2.2. State change</a></li>
</ul>
</li>
<li><a href="#update-records">3.3. Update records</a>
<ul class="sectlevel3">
<li><a href="#schema-3">3.3.1. Schema</a></li>
<li><a href="#validation-2">3.3.2. Validation</a></li>
<li><a href="#state-change-3">3.3.3. State change</a></li>
<li><a href="#utility-functions-2">3.3.4. Utility functions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#creating-the-lns-module">4. Creating the LNS module</a>
<ul class="sectlevel2">
<li><a href="#assets">4.1. Assets</a></li>
<li><a href="#actions">4.2. Actions</a></li>
<li><a href="#reducers">4.3. Reducers</a></li>
<li><a href="#utility-functions-3">4.4. Utility functions</a></li>
</ul>
</li>
<li><a href="#connecting-the-dashboard-plugin">5. Connecting the Dashboard plugin</a></li>
<li><a href="#extending-the-application-cli">6. Extending the application CLI</a></li>
<li><a href="#using-a-plugin-as-frontend">7. Using a plugin as frontend</a></li>
<li><a href="#writing-unit-tests">8. Writing unit tests</a></li>
<li><a href="#writing-network-tests">9. Writing network tests</a></li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="lns-application-overview"><a class="anchor" href="#lns-application-overview"></a>LNS application overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><img src="../_images/tutorials/lns/lns-overview.png" alt="lns overview"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dependencies"><a class="anchor" href="#dependencies"></a>1. Dependencies</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Dependencies</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Git</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v2 (latest)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node.js</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v12 (latest)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lisk Commander</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.1 (latest)</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="node-js"><a class="anchor" href="#node-js"></a>1.1. Node.js</h3>
<div class="paragraph">
<p>If you are using NVM, install the correct version as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">nvm install v12.22.3</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lisk-commander"><a class="anchor" href="#lisk-commander"></a>1.2. Lisk Commander</h3>
<div class="paragraph">
<p>It is recommended to install Lisk Commander globally with NPM to facilitate the convenient usage of the Lisk Commander CLI.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install --global lisk-commander</code></pre>
</div>
</div>
<div class="paragraph">
<p>To check the successful installation of Lisk Commander, run for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ lisk --version
lisk-commander/5.1.5 darwin-x64 node-v12.22.3</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bootstrapping-the-default-application"><a class="anchor" href="#bootstrapping-the-default-application"></a>2. Bootstrapping the default application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Create a dedicated folder <code>lisk-name-service/</code>, which will contain the files for the application.</p>
</div>
<div class="paragraph">
<p>Inside of this folder, execute the <code>lisk init</code> command of Lisk Commander as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mkdir lisk-name-service
cd lisk-name-service
lisk init</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next you will be prompted for the application name, description, author and license.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Using template "lisk-ts"
Initializing git repository
Updating .liskrc.json file
Creating project structure
? Application name lns
? Application description My blockchain application
? Author yourName
? License ISC</pre>
</div>
</div>
<div class="paragraph">
<p>This will generate a lot of new files and folders, resulting in the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.
├── README.md
├── bin <i class="conum" data-value="1"></i><b>(1)</b>
├── config <i class="conum" data-value="2"></i><b>(2)</b>
├── jest.config.js
├── package-lock.json
├── package.json
├── src
│   ├── app <i class="conum" data-value="3"></i><b>(3)</b>
│   │   ├── app.ts <i class="conum" data-value="4"></i><b>(4)</b>
│   │   ├── index.ts
│   │   ├── modules <i class="conum" data-value="5"></i><b>(5)</b>
│   │   ├── modules.ts <i class="conum" data-value="6"></i><b>(6)</b>
│   │   ├── plugins <i class="conum" data-value="7"></i><b>(7)</b>
│   │   └── plugins.ts <i class="conum" data-value="8"></i><b>(8)</b>
│   └── commands <i class="conum" data-value="9"></i><b>(9)</b>
├── test <i class="conum" data-value="10"></i><b>(10)</b>
└── tsconfig.json</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>bin/</code> contains the <code>run</code> script which starts the application CLI.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>config/</code> contains the default configuration and genesis block for the application.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>app/</code> contains the files of the blockchain application.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>app.ts</code> creates the <code>Application</code> instance.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><code>modules/</code> contains the application modules (currently empty).</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><code>modules.ts</code> registers the modules with the application.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td><code>plugins/</code> contains the application plugins (currently empty).</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td><code>plugins.ts</code> registers the plugins with the application.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td><code>commands/</code> contains the application CLI commands.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td><code>tests/</code> contains functional, network and unit tests for the blockchain application.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These files create a ready-to-start blockchain application, configured for a local devnet, which uses only the default modules of the Lisk SDK.</p>
</div>
<div class="paragraph">
<p>The application is created in the file <code>app.ts</code>:</p>
</div>
<div class="listingblock">
<div class="title">src/app/app.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { Application, PartialApplicationConfig, utils } from 'lisk-sdk';
import { registerModules } from './modules';
import { registerPlugins } from './plugins';

export const getApplication = (
	genesisBlock: Record&lt;string, unknown&gt;,
	config: PartialApplicationConfig,
): Application =&gt; {
	const app = Application.defaultApplication(genesisBlock, config); <i class="conum" data-value="1"></i><b>(1)</b>

	registerModules(app); <i class="conum" data-value="2"></i><b>(2)</b>
	registerPlugins(app); <i class="conum" data-value="3"></i><b>(3)</b>

	return app;
};</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Creates blockchain application with the default modules.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Will register additionnal modules to the application.
Currently, no additionnal modules are available for the application.
To add new modules update the <code>modules.ts</code> file.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Will register additionnal plugins to the application.
Currently, no plugins are available for the application.
To add new plugins update the <code>plugins.ts</code> file.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To verify the successful bootstrap of the blockchain application, start it with the following command:</p>
</div>
<div class="listingblock">
<div class="title">lisk-name-service/</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./bin/run start</code></pre>
</div>
</div>
<div class="paragraph">
<p>And observe the displayed log messages in the console.
If on errors are thrown, the application will start to add new locks every 10 seconds after the initial startup.</p>
</div>
<div class="paragraph">
<p>Once it is verified that the application runs correctly, stop the node again with <kbd>Ctrl</kbd> + <kbd>C</kbd>.</p>
</div>
<div class="paragraph">
<p>After the application was started for the first time, the corresponding application data can bbe found under the path <code>~/.lisk/lns/</code></p>
</div>
<div class="listingblock">
<div class="title">~/.lisk/lns/</div>
<div class="content">
<pre>.
├── config
│   └── default
│       ├── config.json <i class="conum" data-value="1"></i><b>(1)</b>
│       └── genesis_block.json <i class="conum" data-value="2"></i><b>(2)</b>
├── data  <i class="conum" data-value="3"></i><b>(3)</b>
│   ├── blockchain.db
│   ├── forger.db
│   ├── genesis_block_compiled
│   └── node.db
├── logs  <i class="conum" data-value="4"></i><b>(4)</b>
│   ├── lisk.log
│   ├── plugin-LnsDashboard.log
│   ├── plugin-forger.log
│   └── plugin-httpApi.log
├── plugins <i class="conum" data-value="5"></i><b>(5)</b>
│   └── data
└── tmp <i class="conum" data-value="6"></i><b>(6)</b>
    ├── pids
    └── sockets</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>config.json</code> is the configuration file of the blockchain application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>genesis_block.json</code> is the genesis block of the blockchain application.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>data</code> contains all on-chain data of the blockchain, stored in key-value stores.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>logs</code> contains the file logs of the application and its' plugins.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><code>plugins</code> contains all off-chain data of the application, stored in key-value-stores.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><code>tmp</code> contains temporary application data.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To customize the default blockchain application to suit our desired use case, we will now generate the LNS module skeleton.</p>
</div>
<div class="paragraph">
<p>Create the module skeleton by executing the command <code>lisk generate:module</code> like shown below:</p>
</div>
<div class="listingblock">
<div class="title">lisk-name-service/</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">lisk generate:module lns 1000</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command expects two arguments:
 . The module name
 . The module ID</p>
</div>
<div class="paragraph">
<p>This will information will be used to create the corresponding module skeleton.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>├── src
│   ├── app
│   │   ├── app.ts
│   │   ├── index.ts
│   │   ├── modules
│   │   │   └── lns.ts
│   │   │       └── lns_module.ts <i class="conum" data-value="1"></i><b>(1)</b>
│   │   ├── modules.ts
│   │   ├── plugins
│   │   └── plugins.ts</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The newly created skeleton for the LNS module</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Read the following sections to learn how to further extend the LNS module to suit the desired use case.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-the-lns-module-assets"><a class="anchor" href="#creating-the-lns-module-assets"></a>3. Creating the LNS module assets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first part of the module that we implement here are the assets to handle the different transaction types <code>register</code>, <code>reverse lookup</code> and <code>update records</code>.</p>
</div>
<div class="sect2">
<h3 id="register-domain"><a class="anchor" href="#register-domain"></a>3.1. Register Domain</h3>
<div class="paragraph">
<p>As first step for creating the asset, use Lisk Commander again, this time, to create the asset skeleton.</p>
</div>
<div class="paragraph">
<p>Execute the following command:</p>
</div>
<div class="listingblock">
<div class="title">lisk-name-service/</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">lisk generate:asset lns register 1</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>├── src
│   ├── app
│   │   ├── app.ts
│   │   ├── index.ts
│   │   ├── modules
│   │   │   └── lns.ts
│   │   │       ├── assets
│   │   │       │   └── register.ts <i class="conum" data-value="1"></i><b>(1)</b>
│   │   │       └── lns_module.ts
│   │   ├── modules.ts
│   │   ├── plugins
│   │   └── plugins.ts</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The newly created skeleton for the <code>register</code> asset.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you open <code>register.ts</code> at this point, it will look like this:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/register.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { BaseAsset, ApplyAssetContext, ValidateAssetContext } from 'lisk-sdk';

export class RegisterAsset extends BaseAsset {
  public name = 'register';
  public id = 1;

  // Define schema for asset
	public schema = {
    $id: 'lns/register-asset',
		title: 'RegisterAsset transaction asset for lns module',
		type: 'object',
		required: [],
		properties: {},
  };

  public validate({ asset }: ValidateAssetContext&lt;{}&gt;): void {
    // Validate your asset
  }

	// eslint-disable-next-line @typescript-eslint/require-await
  public async apply({ asset, transaction, stateStore }: ApplyAssetContext&lt;{}&gt;): Promise&lt;void&gt; {
		throw new Error('Asset "register" apply hook is not implemented.');
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the asset name and ID are already prefilled with the values we provided when creatinng the asset skeleton.</p>
</div>
<div class="paragraph">
<p>As next step, we want to define the asset schema, which defines which kind of data is expected by the application to successfully register a new domain for a user account.</p>
</div>
<div class="sect3">
<h4 id="schema"><a class="anchor" href="#schema"></a>3.1.1. Schema</h4>
<div class="paragraph">
<p>Create a new folder <code>data/</code> inside the <code>lns</code> module folder.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mkdir data</code></pre>
</div>
</div>
<div class="paragraph">
<p>This folder is created to maintain a better overview, and will store all account and asset schemas which are relevant to the LNS module.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mkdir data/assets</code></pre>
</div>
</div>
<div class="paragraph">
<p>Inside the <code>data/assets</code> folder, create a new file <code>register.ts</code>, which will contain the schemas related to the <code>register</code> asset.</p>
</div>
<div class="paragraph">
<p>The first thing we define in the file, is an interface  for the expected asset data of a <code>register</code> transaction.
It describes in a straight-forward way, what data is expected to be in the transaction asset for a successful registration of a new domain.</p>
</div>
<div class="paragraph">
<p>The following information is required for a successful registration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>(string): The domain name to register for the sending account.</p>
</li>
<li>
<p><code>ttl</code>(number): Time-To-Live: Time which needs to pass, until the records for the domain can be updated again.</p>
</li>
<li>
<p><code>registerFor</code>(number): The duration to reserve this domain for the sender account.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The corresponding interface looks like this:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/assets/register.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface RegisterAssetProps {
	name: string;
	ttl: number;
	registerFor: number;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is described in the following asset schema, which is shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/assets/register.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const registerAssetPropsSchema = {
  $id: 'lns/assets/register',
  title: 'RegisterAsset transaction asset for lns module',
  type: 'object',
  required: ['name', 'ttl', 'registerFor'],
  properties: {
    name: {
      dataType: 'string',
      fieldNumber: 1,
    },
    ttl: {
      dataType: 'uint32',
      fieldNumber: 2,
    },
    registerFor: {
      dataType: 'uint32',
      fieldNumber: 3,
    },
  },
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the interface and asset schema to the file and save it.</p>
</div>
<div class="paragraph">
<p>Now,  just include the schema in the asset file:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/register.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { BaseAsset, ApplyAssetContext, ValidateAssetContext } from 'lisk-sdk';
import { RegisterAssetProps, registerAssetPropsSchema } from '../data';

export class RegisterAsset extends BaseAsset&lt;RegisterAssetProps&gt; {
  public name = 'register';
  public id = 1;

  // Define schema for asset
  public schema = registerAssetPropsSchema;

  // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validation"><a class="anchor" href="#validation"></a>3.1.2. Validation</h4>
<div class="paragraph">
<p>Create a new file <code>constants.ts</code> inside the <code>lns</code> module folder.</p>
</div>
<div class="paragraph">
<p>This file is created to maintain a better overview, and will store all constants which are relevant to the LNS module and its' assets.</p>
</div>
<div class="paragraph">
<p>Add the following two constants.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/constants.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const MIN_TTL_VALUE = 60 * 60; // 1 hour
export const VALID_TLDS = ['lsk'];</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now import the constants into the <code>register</code> asset, and use them to check the validity of transaction assets:</p>
</div>
<div class="paragraph">
<p>We want to validate the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The TTL value needs to be above the minimum defined TTL value (60 * 60).</p>
</li>
<li>
<p>The <code>registerFor</code> value needs to be between 1 and 5.</p>
</li>
<li>
<p>Only second level domain names can bbe registered.</p>
</li>
<li>
<p>Only domains with valid TLDs can be registered.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The corresponding checks look like this:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/register.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { BaseAsset, ApplyAssetContext, ValidateAssetContext } from 'lisk-sdk';
import { RegisterAssetProps, registerAssetPropsSchema } from '../data';
import { MIN_TTL_VALUE, VALID_TLDS } from '../constants';

export class RegisterAsset extends BaseAsset&lt;RegisterAssetProps&gt; {

    // ...

  public validate({ asset }: ValidateAssetContext&lt;RegisterAssetProps&gt;): void {
		if (asset.ttl &lt; MIN_TTL_VALUE) {
			throw new Error(`Must set TTL value larger or equal to ${MIN_TTL_VALUE}`);
		}

		if (asset.registerFor &lt; 1) {
			throw new Error('You can register name at least for 1 year.');
		}

		if (asset.registerFor &gt; 5) {
			throw new Error('You can register name maximum for 5 year.');
		}

		const chunks = asset.name.split(/\./);

		if (chunks.length &gt; 2) {
			throw new Error('You can only register second level domain name.');
		}

		if (!VALID_TLDS.includes(chunks[1])) {
			throw new Error(`Invalid TLD found "${chunks[1]}". Valid TLDs are "${VALID_TLDS.join()}"`);
		}
	}

    // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="state-change"><a class="anchor" href="#state-change"></a>3.1.3. State change</h4>
<div class="paragraph">
<p>If the validation of the transaction asset doesn&#8217;t throw any errors, the <code>apply()</code> function is executed, which allows state changes on the blockchain, based on the received transaction data.</p>
</div>
<div class="paragraph">
<p>The following logic is implemented in the <code>apply()</code> function:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Checks, if the domain name was already registered, and throws an error in this case.</p>
</li>
<li>
<p>Creates a new LNS object based on the asset data of the received transaction and saves it in the blockchain.</p>
</li>
<li>
<p>Adds the namehash output of the domain name to the sender account under the key <code>lns.ownNodes</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/register.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { addYears } from 'date-fns';
import { BaseAsset, ApplyAssetContext, ValidateAssetContext } from 'lisk-sdk';
import { LNSAccountProps, RegisterAssetProps, registerAssetPropsSchema } from '../data';
import { createLNSObject, getLNSObject, getNodeForName } from '../storage';
import { MIN_TTL_VALUE, VALID_TLDS } from '../constants';

export class RegisterAsset extends BaseAsset&lt;RegisterAssetProps&gt; {

    // ...

    public async apply({
            asset,
            stateStore,
            transaction,
        }: ApplyAssetContext&lt;RegisterAssetProps&gt;): Promise&lt;void&gt; {
            // Get namehash output of the domain anme
            const node = getNodeForName(asset.name);

            // Check if this domain is already registered on the blockchain
            const existingDomain = await getLNSObject(stateStore, node);
            if (existingDomain) {
                throw new Error(`The name "${asset.name}" already registered`);
            }

            // Create the LNS object and save it on the blockchain
            const lnsObject = {
                name: asset.name,
                ttl: asset.ttl,
                expiry: Math.ceil(addYears(new Date(), asset.registerFor).getTime() / 1000),
                ownerAddress: transaction.senderAddress,
                records: [],
            };
            await createLNSObject(stateStore, lnsObject);

            // Get the sender account
            const sender = await stateStore.account.get&lt;LNSAccountProps&gt;(transaction.senderAddress);

            // Add the namehash output of the domain to the sender account
            sender.lns.ownNodes = [...sender.lns.ownNodes, node];

            // Save the updated sender account on the blockchain
            await stateStore.account.set(sender.address, sender);
        }
    }

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Several utility functions are used inside of the apply function, which are implemented in a new file under the path <code>src/app/modules/lns/storage.ts</code>.
The implementation of these functions is explained in the next question in detail.</p>
</div>
<div class="paragraph">
<p>The <code>LNSAccountProps</code> are imported from the <code>lns/data/</code> folder.
Create a new file <code>lns/data/account_props.ts</code> which exports the <code>LNSAccountProps</code>:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/account_props.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { EMPTY_BUFFER } from "../constants";

export interface LNSAccountProps {
	lns: {
		ownNodes: Buffer[];
		reverseLookup: Buffer;
	};
}

export const lsnAccountPropsSchema = {
	$id: 'lisk/lns/lnsAccount',
	type: 'object',
	required: ['ownNodes', 'reverseLookup'],
	properties: {
		reverseLookup: {
			dataType: 'bytes',
			fieldNumber: 1,
		},
		ownNodes: {
			type: 'array',
			fieldNumber: 2,
			items: {
				dataType: 'bytes',
			},
		},
	},
	default: {
		ownNodes: [],
		reverseLookup: EMPTY_BUFFER,
	},
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, open the file <code>lns/constants.ts</code>, which was created in step <a href="#validation">Validation</a> and add the following constant:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/constants.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const EMPTY_BUFFER = Buffer.alloc(0);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="utility-functions"><a class="anchor" href="#utility-functions"></a>3.1.4. Utility functions</h4>
<div class="paragraph">
<p>Create a new file <code>storage.ts</code> in the LNS module folder.</p>
</div>
<div class="paragraph">
<p>Implement the following functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#getnodefornamename">getNodeForName(name)</a>: Construct a node(namehash output) based on the domain name.</p>
</li>
<li>
<p><a href="#createlnsobjectstatestore-params">createLNSObject(stateStore, params)</a>: A function to create a new LNS object in the database.</p>
</li>
<li>
<p><a href="#getlnsobjectstatestore-node">getLNSObject(stateStore, node)</a>: A function to get a specific LNS object from the database.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="getnodefornamename"><a class="anchor" href="#getnodefornamename"></a>getNodeForName(name)</h5>
<div class="paragraph">
<p>Import the <code>eth-ens-namehash</code> package and create the following functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>getNodeForName: Construct a node(namehash output) based on the domain name.</p>
</li>
<li>
<p>getKeyForNode: Get the unique database key for a specific LNS object.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/storage.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import * as namehash from 'eth-ens-namehash';

// constants
export const LNS_PREFIX = 'LNS';
export const VALID_TLDS = ['lsk'];

// Get a unique key for each LNS object
export const getKeyForNode = (node: Buffer): string =&gt; `${LNS_PREFIX}:${node.toString('hex')}`;
// Create a hash from the domain name and return it as Buffer
export const getNodeForName = (name: string): Buffer =&gt;
	Buffer.from(namehash.hash(name).slice(2), 'hex');</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the creation of the namehash output of the domain, aka node, reuse the <code>hash()</code> function of the <code>eth-ens-namehash</code> NPM package.</p>
</div>
</div>
<div class="sect4">
<h5 id="createlnsobjectstatestore-params"><a class="anchor" href="#createlnsobjectstatestore-params"></a>createLNSObject(stateStore, params)</h5>
<div class="paragraph">
<p>Now implement the function to save a new LNS object in the database by reusing the above defined <code>lnsNodeSchema</code> and the functions <code>getNodeForName</code> and <code>getKeyForNode</code>.</p>
</div>
<div class="paragraph">
<p>The function  <code>createLNSObject()</code> expects thee following two arguments:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>stateStore</code>: the stateStore which is passed from the LNS module later.
The stateStore allows to perform state changes on the blockchain.</p>
</li>
<li>
<p><code>params</code>: the parameters which will be used to create the new LNS object.</p>
<div class="ulist">
<ul>
<li>
<p>ownerAddress</p>
</li>
<li>
<p>name</p>
</li>
<li>
<p>ttl</p>
</li>
<li>
<p>expiry</p>
</li>
<li>
<p>records</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/storage.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { chain, codec, StateStore } from 'lisk-sdk';
import * as namehash from 'eth-ens-namehash';

// ...

export const createLNSObject = async (
	stateStore: StateStore,
	params: Omit&lt;LNSNode, 'createdAt' | 'updatedAt' | 'node'&gt; &amp; { name: string },
): Promise&lt;void&gt; =&gt; {
	const { name, ...lnsObject } = params;
	const node = getNodeForName(name);

	const input: LNSNode = {
		...lnsObject,
		name,
		createdAt: Math.ceil(Date.now() / 1000),
		updatedAt: Math.ceil(Date.now() / 1000),
	};

	await stateStore.chain.set(getKeyForNode(node), codec.encode(lnsNodeSchema, input));
};</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="getlnsobjectstatestore-node"><a class="anchor" href="#getlnsobjectstatestore-node"></a>getLNSObject(stateStore, node)</h5>
<div class="paragraph">
<p>Next, implement the function <code>getLNSObject()</code>, which gets a specific LNS object from the database, based on the provided node value.</p>
</div>
<div class="paragraph">
<p>The function <code>getKeyForNode()</code> is used to get a unique key for the LNS object in the database.</p>
</div>
<div class="paragraph">
<p>The function  <code>createLNSObject()</code> expects thee following two arguments:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>stateStore</code>: the stateStore which is passed from the LNS module later.
The stateStore allows to perform state changes on the blockchain.</p>
</li>
<li>
<p><code>node</code>: The name hash of the LNS object which is requested from the database.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/storage.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { chain, codec, StateStore } from 'lisk-sdk';
import * as namehash from 'eth-ens-namehash';

// ...

export const getLNSObject = async (
	stateStore: StateStore,
	node: Buffer,
): Promise&lt;LNSNode | undefined&gt; =&gt; {
	const result = await stateStore.chain.get(getKeyForNode(node));

	if (!result) {
		return;
	}

	// eslint-disable-next-line consistent-return
	return codec.decode&lt;LNSNode&gt;(lnsNodeSchema, result);
};</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="schemas"><a class="anchor" href="#schemas"></a>3.1.5. Schemas</h4>
<div class="paragraph">
<p>Implement the following interfaces and schemas, which are be used inside the utility functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#lns-node-record-schema">LNS node record schema</a>: Interface and schema for an LNS node record.</p>
</li>
<li>
<p><a href="#lns-node-schema">LNS node schema</a>: Interface and schema for an LNS node.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="lns-node-record-schema"><a class="anchor" href="#lns-node-record-schema"></a>LNS node record schema</h5>
<div class="paragraph">
<p>Create a new file <code>data/lns_node_records.ts</code> in the LNS module folder.</p>
</div>
<div class="paragraph">
<p>The interface for an LNS node record looks like this:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/lns_node_records.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface LNSNodeRecord {
	type: number; <i class="conum" data-value="1"></i><b>(1)</b>
	label: string; <i class="conum" data-value="2"></i><b>(2)</b>
	value: string; <i class="conum" data-value="3"></i><b>(3)</b>
}

export type LNSNodeRecordJSON = LNSNodeRecord;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>type</code>: Type of the records as number.
<code>1</code> stands for a CNAME record, <code>2</code> stands for a TXT record.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>label</code>: Label for the record.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>value</code>: Value for the record.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Based on this interface, we can create the corresponding schema, which looks like this:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/lns_node_records.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const lnsNodeRecordSchema = {
	$id: 'lisk/lns/lnsNodeRecord',
	type: 'object',
	required: ['type', 'label', 'value'],
	properties: {
		type: {
			dataType: 'uint32',
			fieldNumber: 1,
		},
		label: {
			dataType: 'string',
			fieldNumber: 2,
		},
		value: {
			dataType: 'string',
			fieldNumber: 3,
		}
	},
};</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="lns-node-schema"><a class="anchor" href="#lns-node-schema"></a>LNS node schema</h5>
<div class="paragraph">
<p>Create a new file <code>data/lns_node.ts</code> in the LNS module folder.</p>
</div>
<div class="paragraph">
<p>First define an interface which illustrates, how the LNS object will look like:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/lns_node.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface LNSNode {
	ownerAddress: Buffer; <i class="conum" data-value="1"></i><b>(1)</b>
	name: string;<i class="conum" data-value="2"></i><b>(2)</b>
	ttl: number;<i class="conum" data-value="3"></i><b>(3)</b>
	expiry: number;<i class="conum" data-value="4"></i><b>(4)</b>
	records: LNSNodeRecord[];<i class="conum" data-value="5"></i><b>(5)</b>
	createdAt: number;<i class="conum" data-value="6"></i><b>(6)</b>
	updatedAt: number;<i class="conum" data-value="7"></i><b>(7)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>ownerAddress</code>: The address of the domain owner as Buffer.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>name</code>: The domain name as String.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>ttl</code>: The TTL in seconds as number.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>expiry</code>: The amount of years until the domain registration expires as number.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><code>records</code>: A list of all existing records for this domain as <a href="#lns-node-record-schema">LNSNodeRecord</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><code>createdAt</code>: Date of the domain registration as number.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td><code>updatedAt</code>: Date of the last update of the domain and its' records as number.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Based on this interface, we can create the corresponding schema, which looks like this:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/lns_node.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const lnsNodeSchema = {
	$id: 'lisk/lns/lnsNode',
	type: 'object',
	required: ['ownerAddress', 'name', 'ttl', 'expiry', 'records', 'createdAt', 'updatedAt'],
	properties: {
		ownerAddress: {
			dataType: 'bytes',
			fieldNumber: 1,
		},
		name: {
			dataType: 'string',
			fieldNumber: 2,
		},
		ttl: {
			dataType: 'uint32',
			fieldNumber: 3,
		},
		expiry: {
			dataType: 'uint32',
			fieldNumber: 4,
		},
		createdAt: {
			dataType: 'uint32',
			fieldNumber: 5,
		},
		updatedAt: {
			dataType: 'uint32',
			fieldNumber: 6,
		},
		records: {
			type: 'array',
			fieldNumber: 7,
			items: {
				...lnsNodeRecordSchema,
			},
		},
	},
};</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="update-reverse-lookup"><a class="anchor" href="#update-reverse-lookup"></a>3.2. Update reverse lookup</h3>
<div class="paragraph">
<p>Now that the first asset is prepared, and first utility function to store and get LNS objects from the database are implemented, let&#8217;s move on to implement the second required asset for updating the reverse lookup of a domain for an account.</p>
</div>
<div class="paragraph">
<p>While 'regular' lookup involves mapping from a name to an address, reverse lookup maps from an address back to a domain.
This allows applications to display LNS names in place of hexadecimal addresses.</p>
</div>
<div class="paragraph">
<p>Because an account can register multiple domains, it is important to define, to which domain the address should resolve to by default.</p>
</div>
<div class="paragraph">
<p>To do this, the account owner needs to send a reverse lookup transaction to update the default domain, their account address should default to.</p>
</div>
<div class="paragraph">
<p>Similar to the register asset, use Lisk Commander to first generate the asset skeleton.
Use <code>reverse_lookup</code>  as asset name and <code>2</code> as asset ID.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">lisk generate:asset lns reverse_lookup 2</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="schema-2"><a class="anchor" href="#schema-2"></a>3.2.1. Schema</h4>
<div class="paragraph">
<p>Create a new file und the path <code>src/app/modules/lns/data/assets/reverse_lookup.ts</code> and add the asset schema for the reverse lookup transaction.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface ReverseLookupAssetProps {
	name: string;
}

export const reverseLookupAssetPropsSchema = {
  $id: 'lns/assets/set-lookup',
  title: 'SetLookup transaction asset for lns module',
  type: 'object',
  required: ['name'],
  properties: {
    name: {
      dataType: 'string',
      fieldNumber: 1,
    },
  },
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the interface and asset schema to the file and save it.</p>
</div>
<div class="paragraph">
<p>Now include the schema in the asset file:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/reverse_lookup.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { ApplyAssetContext, BaseAsset } from 'lisk-sdk';
import { LNSAccountProps, ReverseLookupAssetProps, reverseLookupAssetPropsSchema } from '../data';
import { getNodeForName } from '../storage';

export class ReverseLookupAsset extends BaseAsset&lt;ReverseLookupAssetProps&gt; {
	public name = 'reverse-lookup';
	public id = 2;

	// Define schema for asset
	public schema = reverseLookupAssetPropsSchema;

  // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="state-change-2"><a class="anchor" href="#state-change-2"></a>3.2.2. State change</h4>
<div class="paragraph">
<p>The validation is not required for the reverse lookup transaction asset, so we can directly move on to implement the apply()` function.</p>
</div>
<div class="paragraph">
<p>The following logic is implemented:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Check, if the domain name was already registered and if the transactionn sender owns this domain, and throw an error if not.</p>
</li>
<li>
<p>Add the hash value of the domain as reverse lookup domain to the senders account under the key <code>lns.reverseLookup</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/reverse_lookup.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">public async apply({
    asset,
    stateStore,
    transaction,
}: ApplyAssetContext&lt;ReverseLookupAssetProps&gt;): Promise&lt;void&gt; {
    const node = getNodeForName(asset.name);
    const sender = await stateStore.account.get&lt;LNSAccountProps&gt;(transaction.senderAddress);

    const exists = sender.lns.ownNodes.find(n =&gt; n.equals(node));

    if (!exists) {
        throw new Error('You can only assign lookup node which you own.');
    }

    sender.lns.reverseLookup = node;
    await stateStore.account.set(sender.address, sender);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="update-records"><a class="anchor" href="#update-records"></a>3.3. Update records</h3>
<div class="paragraph">
<p>Finally, create the asset for updating the records of a domain.
This is the last of the three assets in the LNS module.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <a href="https://en.wikipedia.org/wiki/CNAME_record" target="_blank" rel="noopener">CNAME</a> and <a href="https://en.wikipedia.org/wiki/TXT_record" target="_blank" rel="noopener">TXT</a> records have no distinct difference in the LNS blockchain application.
A different handling of the records can be implemented at later stage.
I.e. if you build any DNS provider service on top of the LNS app, then you can use CNAME and TXT records differently there.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">lisk generate:asset lns update_records 3</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="schema-3"><a class="anchor" href="#schema-3"></a>3.3.1. Schema</h4>
<div class="paragraph">
<p>Create a new file for schemas under the path <code>lns/data/assets/update_records.ts</code> and paste the asset schema for the "update records" transaction.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/assets/update_records.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { LNSNodeRecord, lnsNodeRecordSchema } from "../lns_node_record";

export interface UpdateRecordsAssetProps {
  name: string;
  records: LNSNodeRecord[];
}

export const updateRecordsAssetPropsSchema = {
  $id: 'lns/assets/update-records',
  title: 'Update Records transaction asset for lns module',
  type: 'object',
  required: ['records'],
  properties: {
    name: {
      dataType: 'string',
      fieldNumber: 1,
    },
    records: {
      type: 'array',
      fieldNumber: 2,
      items: {
				...lnsNodeRecordSchema,
			},
    }
  },
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now include the schema in the asset file.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/reverse_lookup.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { ApplyAssetContext, BaseAsset, ValidateAssetContext } from 'lisk-sdk';
import { LNSAccountProps, UpdateRecordsAssetProps, updateRecordsAssetPropsSchema } from '../data';

export class UpdateRecordsAsset extends BaseAsset&lt;UpdateRecordsAssetProps&gt; {
	public name = 'update-records';
	public id = 3;

	// Define schema for asset
	public schema = updateRecordsAssetPropsSchema;

  // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validation-2"><a class="anchor" href="#validation-2"></a>3.3.2. Validation</h4>
<div class="paragraph">
<p>Open the file <code>lns/constants.ts</code>, which was created in step <a href="#validation">Validation</a>, and add the following constants:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/constants.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const VALID_RECORD_TYPES = [CNAME_RECORD_TYPE, TXT_RECORD_TYPE];
export const MAX_RECORDS = 50;
export const MIN_RECORD_LABEL_LENGTH = 3;
export const MAX_RECORD_LABEL_LENGTH = 15;
export const MIN_RECORD_VALUE_LENGTH = 3;
export const MAX_RECORD_VALUE_LENGTH = 255;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, import the constants inside of <code>update_records.ts</code> and implement the <code>validate</code> function as follows:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/update_records.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { ApplyAssetContext, BaseAsset, ValidateAssetContext } from 'lisk-sdk';
import {
	MAX_RECORDS,
	MAX_RECORD_LABEL_LENGTH,
	MAX_RECORD_VALUE_LENGTH,
	MIN_RECORD_LABEL_LENGTH,
	MIN_RECORD_VALUE_LENGTH,
	VALID_RECORD_TYPES,
} from '../constants';
import { LNSAccountProps, UpdateRecordsAssetProps, updateRecordsAssetPropsSchema } from '../data';

export class UpdateRecordsAsset extends BaseAsset&lt;UpdateRecordsAssetProps&gt; {
	public name = 'update-records';
	public id = 3;

	// Define schema for asset
	public schema = updateRecordsAssetPropsSchema;

	// Define asset validation
	public validate({ asset }: ValidateAssetContext&lt;UpdateRecordsAssetProps&gt;): void {
	    // Check, if number of records to be updated is below the maximum allowed amount (here: MAX_RECORDS = 50)
		if (asset.records.length &gt; MAX_RECORDS) {
			throw new Error(`Can associate maximum ${MAX_RECORDS} records. Got ${asset.records.length}.`);
		}

		const recordKeys = new Set(asset.records.map(r =&gt; `${r.type.toString()}:${r.label}`));

		// Checks if all records are unique
		if (recordKeys.size !== asset.records.length) {
			throw new Error('Records should be unique among type and label');
		}

		for (const record of asset.records) {
		    // Checks if all records have valid record types
			if (!VALID_RECORD_TYPES.includes(record.type)) {
				throw new Error(
					`Invalid record type "${
						record.type
					}". Valid record types are ${VALID_RECORD_TYPES.join()}`,
				);
			}
			// Checks, if record labels have a valid length
			if (
				record.label.length &gt; MAX_RECORD_LABEL_LENGTH ||
				record.label.length &lt; MIN_RECORD_LABEL_LENGTH
			) {
				throw new Error(
					`Record label can be between ${MIN_RECORD_LABEL_LENGTH}-${MAX_RECORD_LABEL_LENGTH}.`,
				);
			}
            // Checks, if record values have a valid length
			if (
				record.value.length &gt; MAX_RECORD_VALUE_LENGTH ||
				record.value.length &lt; MIN_RECORD_VALUE_LENGTH
			) {
				throw new Error(
					`Record value can be between ${MIN_RECORD_VALUE_LENGTH}-${MAX_RECORD_VALUE_LENGTH}.`,
				);
			}
		}
	}

    // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="state-change-3"><a class="anchor" href="#state-change-3"></a>3.3.3. State change</h4>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/update_records.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { ApplyAssetContext, BaseAsset, ValidateAssetContext } from 'lisk-sdk';
import {
	MAX_RECORDS,
	MAX_RECORD_LABEL_LENGTH,
	MAX_RECORD_VALUE_LENGTH,
	MIN_RECORD_LABEL_LENGTH,
	MIN_RECORD_VALUE_LENGTH,
	VALID_RECORD_TYPES,
} from '../constants';
import { LNSAccountProps, UpdateRecordsAssetProps, updateRecordsAssetPropsSchema } from '../data';
import { getLNSObject, updateLNSObject, getNodeForName } from '../storage';
import { isTTLPassed } from '../utils';

export class UpdateRecordsAsset extends BaseAsset&lt;UpdateRecordsAssetProps&gt; {
	public name = 'update-records';
	public id = 3;

	// ...

	public async apply({
		asset,
		stateStore,
		transaction,
	}: ApplyAssetContext&lt;UpdateRecordsAssetProps&gt;): Promise&lt;void&gt; {
	    // Get the sender account from the database
		const sender = await stateStore.account.get&lt;LNSAccountProps&gt;(transaction.senderAddress);
		// Get the hash of the name
		const node = getNodeForName(asset.name);
		// Get the LNS object from the database
		const lnsObject = await getLNSObject(stateStore, node);
		// Validate, if the corresponding LNS object exists
		if (!lnsObject) {
			throw new Error(`LNS object with name "${asset.name}" is not registered`);
		}
        // Validate, that the sender registered the LNS object
		if (!lnsObject.ownerAddress.equals(sender.address)) {
			throw new Error('Only owner of hte LNS object can update records.');
		}
        // Validate, that the TTL for this LNS object to update the records has passed
		if (!isTTLPassed(lnsObject)) {
			throw new Error('You have to wait for TTL from the last update.');
		}
        // Update the LNS object with the new records from the asset
		await updateLNSObject(stateStore, { node, records: asset.records });
	}

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The function <code>updateLNSObject()</code> is a new function which is added to the utility functions in the next section.</p>
</div>
</div>
<div class="sect3">
<h4 id="utility-functions-2"><a class="anchor" href="#utility-functions-2"></a>3.3.4. Utility functions</h4>
<div class="paragraph">
<p>Open the file <code>storage.ts</code> which was previously created in step <a href="#utility-functions">Utility functions</a>, and define a new function <code>updateLSNObject()</code> which updates a certain LNS object in the database, based on provided parameters.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/storage.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const updateLSNObject = async (
	stateStore: StateStore,
	params: Partial&lt;Omit&lt;LNSNode, 'createdAt' | 'updatedAt'&gt;&gt; &amp; { node: Buffer },
): Promise&lt;void&gt; =&gt; {
	const lnsObject = await getLNSObject(stateStore, params.node);

	if (!lnsObject) {
		throw new Error('No lns object is associated with this name');
	}

	lnsObject.ttl = params.ttl ?? lnsObject.ttl;
	lnsObject.ownerAddress = params.ownerAddress ?? lnsObject.ownerAddress;
	lnsObject.expiry = params.expiry ?? lnsObject.expiry;
	lnsObject.records = params.records ?? lnsObject.records;

	lnsObject.updatedAt = Math.ceil(Date.now() / 1000);

	await stateStore.chain.set(getKeyForNode(params.node), codec.encode(lnsNodeSchema, lnsObject));
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this, all the required assets of the LNS blockchain application are implemented.
The final step is now to add them to module, which will be done in the next chapter, where the LNS module is implemented.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-the-lns-module"><a class="anchor" href="#creating-the-lns-module"></a>4. Creating the LNS module</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To implement the LNS module, take a look again at the module skeleton, which was generated in step <a href="#bootstrapping-the-default-application">Bootstrapping the default application</a>:</p>
</div>
<div class="listingblock">
<div class="title">lns/lns_module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {
    BaseModule,
    AfterBlockApplyContext,
    TransactionApplyContext,
    BeforeBlockApplyContext,
    AfterGenesisBlockApplyContext,
    // GenesisConfig
} from 'lisk-sdk';

export class LnsModule extends BaseModule {
    public actions = {
        // Example below
        // getBalance: async (params) =&gt; this._dataAccess.account.get(params.address).token.balance,
        // getBlockByID: async (params) =&gt; this._dataAccess.blocks.get(params.id),
    };
    public reducers = {
        // Example below
        // getBalance: async (
		// 	params: Record&lt;string, unknown&gt;,
		// 	stateStore: StateStore,
		// ): Promise&lt;bigint&gt; =&gt; {
		// 	const { address } = params;
		// 	if (!Buffer.isBuffer(address)) {
		// 		throw new Error('Address must be a buffer');
		// 	}
		// 	const account = await stateStore.account.getOrDefault&lt;TokenAccount&gt;(address);
		// 	return account.token.balance;
		// },
    };
    public name = 'lns';
    public transactionAssets = [];
    public events = [
        // Example below
        // 'hello:newBlock',
    ];
    public id = 1000;

    // public constructor(genesisConfig: GenesisConfig) {
    //     super(genesisConfig);
    // }

    // Lifecycle hooks
    public async beforeBlockApply(_input: BeforeBlockApplyContext) {
        // Get any data from stateStore using block info, below is an example getting a generator
        // const generatorAddress = getAddressFromPublicKey(_input.block.header.generatorPublicKey);
		// const generator = await _input.stateStore.account.get&lt;TokenAccount&gt;(generatorAddress);
    }

    public async afterBlockApply(_input: AfterBlockApplyContext) {
        // Get any data from stateStore using block info, below is an example getting a generator
        // const generatorAddress = getAddressFromPublicKey(_input.block.header.generatorPublicKey);
		// const generator = await _input.stateStore.account.get&lt;TokenAccount&gt;(generatorAddress);
    }

    public async beforeTransactionApply(_input: TransactionApplyContext) {
        // Get any data from stateStore using transaction info, below is an example
        // const sender = await _input.stateStore.account.getOrDefault&lt;TokenAccount&gt;(_input.transaction.senderAddress);
    }

    public async afterTransactionApply(_input: TransactionApplyContext) {
        // Get any data from stateStore using transaction info, below is an example
        // const sender = await _input.stateStore.account.getOrDefault&lt;TokenAccount&gt;(_input.transaction.senderAddress);
    }

    public async afterGenesisBlockApply(_input: AfterGenesisBlockApplyContext) {
        // Get any data from genesis block, for example get all genesis accounts
        // const genesisAccounts = genesisBlock.header.asset.accounts;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the following values have been pre-filled when creating the LNS module with Lisk Commander in step <a href="#bootstrapping-the-default-application">Bootstrapping the default application</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: The module name (here: <code>lns</code>).</p>
</li>
<li>
<p><code>id</code>: The module ID (here: <code>1000</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We will now implement the following parts of the skeleton:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#assets">Assets</a></p>
</li>
<li>
<p><a href="#actions">Actions</a></p>
</li>
<li>
<p><a href="#reducers">Reducers</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The events and lifecycle hooks are not required in this use case, so you can leave the skeletons as they are.</p>
</div>
<div class="sect2">
<h3 id="assets"><a class="anchor" href="#assets"></a>4.1. Assets</h3>
<div class="paragraph">
<p>Now, let&#8217;s add the assets we created before in step <a href="#creating-the-lns-module-assets">Creating the LNS module assets</a>.
Import the different assets to the LNS module as shown in the snippet below.</p>
</div>
<div class="paragraph">
<p>Then, create a new instance of each asset and add them as array to the <code>transactionAssets</code> property of the LNS module.</p>
</div>
<div class="listingblock">
<div class="title">lns/lns_module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { RegisterAsset } from './assets/register';
import { UpdateRecordsAsset } from './assets/update_records';
import { ReverseLookupAsset } from './assets/reverse_lookup';

export class LnsModule extends BaseModule {
    // ...
    public transactionAssets = [
		new RegisterAsset(),
		new ReverseLookupAsset(),
		new UpdateRecordsAsset(),
	];
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s all that is needed to add new assets to the LNS module.</p>
</div>
</div>
<div class="sect2">
<h3 id="actions"><a class="anchor" href="#actions"></a>4.2. Actions</h3>
<div class="paragraph">
<p>The LNS module should have the following actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>lookupAddress</code>: returns an LNS object based on a provided account address.</p>
</li>
<li>
<p><code>resolveName</code>: returns an LNS object based on a domain name.</p>
</li>
<li>
<p><code>resolveNode</code>: returns an LNS object based on a node hash value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All three actions are returning an <a href="#lns-node-schema">LNS object</a>, based on differeent input parameters like the address it os registered to, the domain name that is registered in the LNS object, or a hash of the LNS object, which is typically stored in user account under <code>lns.ownNodes</code>.</p>
</div>
<div class="paragraph">
<p>The main logic of the different actions is imported from the file <code>storage.ts</code>, and is explained in detail in step <a href="#utility-functions-3">Utility functions</a>.</p>
</div>
<div class="listingblock">
<div class="title">lns/lns_module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {
    BaseModule,
    codec,
    AfterBlockApplyContext,
    TransactionApplyContext,
    BeforeBlockApplyContext,
    AfterGenesisBlockApplyContext,
    // GenesisConfig
} from 'lisk-sdk';
import { RegisterAsset } from './assets/register';
import { UpdateRecordsAsset } from './assets/update_records';
import { ReverseLookupAsset } from './assets/reverse_lookup';
import { LNSNode, LNSNodeJSON, lnsNodeSchema, lsnAccountPropsSchema } from './data';
import { lookupAddress, resolveName, resolveNode } from './storage';

export class LnsModule extends BaseModule {
    public actions = {
		lookupAddress: async (params: Record&lt;string, unknown&gt;): Promise&lt;LNSNodeJSON&gt; =&gt; {
			const lnsObject = await lookupAddress({
				accountGetter: this._dataAccess.getAccountByAddress.bind(this),
				chainGetter: this._dataAccess.getChainState.bind(this),
				address: Buffer.from((params as { address: string }).address, 'hex'),
			});

			return codec.toJSON(lnsNodeSchema, lnsObject);
		},
		resolveName: async (params: Record&lt;string, unknown&gt;): Promise&lt;LNSNodeJSON&gt; =&gt; {
			const lnsObject = await resolveName({
				chainGetter: this._dataAccess.getChainState.bind(this),
				name: (params as { name: string }).name,
			});

			return codec.toJSON(lnsNodeSchema, lnsObject);
		},
		resolveNode: async (params: Record&lt;string, unknown&gt;): Promise&lt;LNSNodeJSON&gt; =&gt; {
			const lnsObject = await resolveNode({
				chainGetter: this._dataAccess.getChainState.bind(this),
				node: Buffer.from((params as { node: string }).node, 'hex'),
			});

			return codec.toJSON(lnsNodeSchema, lnsObject);
		},
	};
    // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="reducers"><a class="anchor" href="#reducers"></a>4.3. Reducers</h3>
<div class="paragraph">
<p>The methods needed in reducers are very similar to the methods in <a href="#actions">Actions</a> above.
The only difference is, that the <code>StateStore</code> is available inside of reducers, so let&#8217;s use it instead of <code>dataAccess</code> to query the database:</p>
</div>
<div class="listingblock">
<div class="title">lns/lns_module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {
    BaseModule,
    codec,
    StateStore,
    AfterBlockApplyContext,
    TransactionApplyContext,
    BeforeBlockApplyContext,
    AfterGenesisBlockApplyContext,
    // GenesisConfig
} from 'lisk-sdk';
import { RegisterAsset } from './assets/register';
import { UpdateRecordsAsset } from './assets/update_records';
import { ReverseLookupAsset } from './assets/reverse_lookup';
import { LNSNode, LNSNodeJSON, lnsNodeSchema, lsnAccountPropsSchema } from './data';
import { lookupAddress, resolveName, resolveNode } from './storage';

export class LnsModule extends BaseModule {
    // ...
    public reducers = {
		lookupAddress: async (
			params: Record&lt;string, unknown&gt;,
			stateStore: StateStore,
		): Promise&lt;LNSNode&gt; =&gt;
			lookupAddress({
				accountGetter: stateStore.account.get.bind(this),
				chainGetter: stateStore.chain.get.bind(this),
				address: (params as { address: Buffer }).address,
			}),
		resolveName: async (
			params: Record&lt;string, unknown&gt;,
			stateStore: StateStore,
		): Promise&lt;LNSNode&gt; =&gt;
			resolveName({
				chainGetter: stateStore.chain.get.bind(this),
				name: (params as { name: string }).name,
			}),
		resolveNode: async (
			params: Record&lt;string, unknown&gt;,
			stateStore: StateStore,
		): Promise&lt;LNSNode&gt; =&gt;
			resolveNode({
				chainGetter: stateStore.chain.get.bind(this),
				node: (params as { node: Buffer }).node,
			}),
	};
    // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="utility-functions-3"><a class="anchor" href="#utility-functions-3"></a>4.4. Utility functions</h3>
<div class="paragraph">
<p>Add the code of the functions <code>resolveNode()</code>, resolveName()` and <code>lookupAddress()</code> to the file <code>storage.ts</code>, to complete the implementation of the actions and reducers of the LNS module.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/storage.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import * as namehash from 'eth-ens-namehash';
import { chain, codec, StateStore } from 'lisk-sdk';
import { EMPTY_BUFFER, LNS_PREFIX } from './constants';
import { LNSAccountProps, LNSNode, lnsNodeSchema } from './data';
import { isExpired } from './utils';

export const getKeyForNode = (node: Buffer): string =&gt; `${LNS_PREFIX}:${node.toString('hex')}`;
export const getNodeForName = (name: string): Buffer =&gt;
	Buffer.from(namehash.hash(name).slice(2), 'hex');

export const resolveNode = async ({
	chainGetter,
	node,
}: {
	chainGetter: (address: string) =&gt; Promise&lt;Buffer | undefined&gt;;
	node: Buffer;
}): Promise&lt;LNSNode&gt; =&gt; {
	const result = await chainGetter(getKeyForNode(node));

	if (!result) {
		throw new Error(`Node "${node.toString('hex')}" could not resolve.`);
	}

	const lnsNode = codec.decode&lt;LNSNode&gt;(lnsNodeSchema, result);

	if (isExpired(lnsNode)) {
		throw new Error(`Node "${node.toString('hex')}" is associated to an expired LNS object.`);
	}

	return lnsNode;
};

export const resolveName = async ({
	chainGetter,
	name,
}: {
	chainGetter: (address: string) =&gt; Promise&lt;Buffer | undefined&gt;;
	name: string;
}): Promise&lt;LNSNode&gt; =&gt; {
	const result = await chainGetter(getKeyForNode(getNodeForName(name)));

	if (!result) {
		throw new Error(`Name "${name}" could not resolve.`);
	}

	const lnsNode = codec.decode&lt;LNSNode&gt;(lnsNodeSchema, result);

	if (isExpired(lnsNode)) {
		throw new Error(`Name "${name}" is associated to an expired LNS object.`);
	}

	return lnsNode;
};

export const lookupAddress = async ({
	accountGetter,
	chainGetter,
	address,
}: {
	accountGetter: (address: Buffer) =&gt; Promise&lt;chain.Account&lt;LNSAccountProps&gt;&gt;;
	chainGetter: (address: string) =&gt; Promise&lt;Buffer | undefined&gt;;
	address: Buffer;
}): Promise&lt;LNSNode&gt; =&gt; {
	let account: chain.Account&lt;LNSAccountProps&gt;;

	try {
		account = await accountGetter(address);
	} catch {
		throw new Error(`Lookup account "${address.toString('hex')}" not found.`);
	}

	if (account.lns.reverseLookup === EMPTY_BUFFER) {
		throw new Error(`Account "${address.toString('hex')}" is not associated with any LNS object.`);
	}

	const result = await chainGetter(getKeyForNode(account.lns.reverseLookup));

	if (!result) {
		throw new Error(`Problem looking up node "${account.lns.reverseLookup.toString('hex')}"`);
	}

	const lnsNode = codec.decode&lt;LNSNode&gt;(lnsNodeSchema, result);

	if (isExpired(lnsNode)) {
		throw new Error(`Account "${address.toString('hex')}" is associated to an expired LNS object.`);
	}

	return lnsNode;
};

// ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Don&#8217;t forget to add a new interface for <code>LNSNodeJSON</code> to the file <code>data/lns_node.ts</code>.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/lns_node.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// ...
export interface LNSNodeJSON {
	ownerAddress: string;
	name: string;
	ttl: number;
	expiry: number;
	records: LNSNodeRecordJSON[];
	createdAt: number;
	updatedAt: number;
}
// ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this last step, all required parts of the LNS module are implemented.
Before we go on with developing the frontend part, let&#8217;s quickly check if the blockchain application is working as expected by enabling the Dashboard plugin in the next chapter.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connecting-the-dashboard-plugin"><a class="anchor" href="#connecting-the-dashboard-plugin"></a>5. Connecting the Dashboard plugin</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript"></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="extending-the-application-cli"><a class="anchor" href="#extending-the-application-cli"></a>6. Extending the application CLI</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript"></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-a-plugin-as-frontend"><a class="anchor" href="#using-a-plugin-as-frontend"></a>7. Using a plugin as frontend</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript"></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="writing-unit-tests"><a class="anchor" href="#writing-unit-tests"></a>8. Writing unit tests</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="writing-network-tests"><a class="anchor" href="#writing-network-tests"></a>9. Writing network tests</h2>
<div class="sectionbody">

</div>
</div>
    <div class="bottom-links">
    <div>
      <a class="bottom-link" href="/documentation/lisk-sdk/tutorials/srs.html"><i class="icofont-double-left icofont-3x"></i>Social Recovery System (SRS) Tutorial
    </a>
    </div><div>
      <a class="bottom-link" href="/documentation/lisk-sdk/references/application-cli.html">Application CLI Commands<i class="icofont-double-right icofont-3x"></i>
      </a>
    </div>
  </div>






<!--{]> pagination}}-->
</article>
<aside class="article-aside hidden" role="navigation">
</aside>


<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
  </div>
</div>
<footer class="footer">
    <div class="footer__container">
        <div class="footer__copyright">
            <div class="institutional-links-2">
                <span class="institutional-links-2__item">© 2021 Lisk Foundation</span>
              <ul class="footer-links">
                <li><a class="institutional-links-2__item" href="https://lisk.io/terms-conditions" class="institutional-links-2-item">Terms & Conditions</a></li>
                <li><a class="institutional-links-2__item" href="https://lisk.io/privacy" class="institutional-links-2-item">Privacy Policy</a></li>
                <li><a class="institutional-links-2__item" href="https://lisk.io/contact" class="institutional-links-2-item">Contact</a></li>
              </ul>
            </div>
            <p class="footer__copyright-text">Lisk is a foundation registered in Zug, Switzerland
            </p>
        </div>
        <div class="footer__logo-container">
            <img src="../../_/img/lisk-logo-light.svg" class="footer__lisk-logo"/>
        </div>
        <div class="community-section">
            <p class="community-section__text">Follow Lisk on: </p>
            <div class="community-section__icons">
                <a href="https://github.com/LiskHQ" title="GitHub" target="_blank" class="footer__icon icon-github"></a>
                <a href="https://twitter.com/LiskHQ" title="Twitter" target="_blank" class="footer__icon icon-twitter"></a>
                <a href="https://lisk.chat" title="Discord" target="_blank" class="footer__icon icon-discord"></a>
                <a href="https://www.reddit.com/r/Lisk/" title="Reddit" target="_blank" class="footer__icon icon-reddit"></a>
                <a href="https://www.facebook.com/LiskHQ" title="Facebook" target="_blank" class="footer__icon icon-facebook"></a>
            </div>
        </div>
    </div>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/tabs-block-behaviour.js"></script>
<script async src="../../_/js/vendor/top-versions.js"></script>
<script async src="../../_/js/vendor/custom.js"></script>
  <script src="../../_/js/vendor/docsearch.min.js"></script>
  <!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js -->
  <script>
    function focusSearchInput () { document.querySelector('#search-input').focus() }
    var search = docsearch({
        appId: 'C4SU57KGV9',
      apiKey: '55aa8709b04eb62f08f87571cf77547c',
      indexName: 'lisk-docs-search',
      inputSelector: '#search-input',
      autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
      algoliaOptions: { hitsPerPage: 10 }
    }).autocomplete
    search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
    focusSearchInput()
    window.addEventListener('load', focusSearchInput)
  </script>

  </body>
</html>
